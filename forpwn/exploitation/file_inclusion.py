import requests
import re
from urllib.parse import urljoin

def expolit(url, payload):
    headers = {
        "Content-Type": "application/x-www-form-urlencoded",
        "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/",
        "Accept": "*/*",
        "Accept-Encoding": "gzip, deflate",
        "Accept-Language": "zh-CN,zh;q=0.9,ko;q=0.8",
        "Connection": "keep-alive"
    }
    response = requests.get(url, headers=headers)
    if response.status_code == 200:
        flag_pattern = r"flag\{.*?\}"
        flag_match = re.search(flag_pattern, response.text)
        if flag_match:
            return flag_match.group(0)
        else:
            return "Flag not found."
    else:
        return "Request failed with status code:", response.status_code
