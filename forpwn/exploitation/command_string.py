from logger import logger
from pwn import *

def expolit(url, payload_type, payload):
    assert payload_type == "command"
    logger.info(f"in function command_string, {url = }")
    logger.info(f"in function command_string, {payload = }")
    ip, port = url.split(":")
    port = int(port)
    io = remote(ip, port)
    io.sendline(payload)
    flag = io.recvline().decode()
    logger.info(f"in function command_string, {flag = }")
    io.close()
    if "flag" in flag:
        return flag, None
    else:
        return None, "Flag not found."