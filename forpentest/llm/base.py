import asyncio

from logger import logger

def extract_from_json(data, *keys):
    if data is None:
        return (None for key in keys)
    try:
        return (data[key] for key in keys)
    except Exception as e:
        logger.error(f"Read from json data failed. ")
        return (None for key in keys)

class LLMSolver:
    def __init__(self, system_prompt):
        self.history = [{"role": "system", "content": system_prompt},]
        self.checkpoints = [len(self.history)]

    def commit(self):
        self.checkpoints.append(len(self.history))

    def revert(self):
        self.history = self.history[:self.checkpoints[-1]]

    def commit_or_revert(self, f):
        if f:
            self.commit()
        else:
            self.revert()

    def rollback(self):
        self.checkpoints.pop()
        self.revert()

